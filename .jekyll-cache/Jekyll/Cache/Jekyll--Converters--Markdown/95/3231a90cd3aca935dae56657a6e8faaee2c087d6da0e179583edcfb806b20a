I"#<h2 id="ç½‘ç«™æœåŠ¡ç¨‹åº">ç½‘ç«™æœåŠ¡ç¨‹åº</h2>
<h4 id="ä¸€ä¸ªç®€å•çš„å®ä¾‹">ä¸€ä¸ªç®€å•çš„å®ä¾‹</h4>
<ol>
  <li>æŒ‚è½½é•œåƒï¼Œä½¿ç”¨Yumä¸‹è½½ httpd <code class="highlighter-rouge">yum install httpd</code></li>
  <li>å¯ç”¨<code class="highlighter-rouge">httpd</code>æœåŠ¡ç¨‹åºå¹¶æ·»åŠ åˆ°å¼€æœºé¡¹   <code class="highlighter-rouge">systemctl start httpd</code> <code class="highlighter-rouge">systemctl enable httpd</code></li>
  <li>æµ‹è¯•ï¼šæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥<code class="highlighter-rouge">127.0.0.1</code>å³å¯çœ‹åˆ°ï¼ˆæ–‡ä»¶è·¯å¾„ï¼š<code class="highlighter-rouge">/var/www</code>ï¼‰</li>
</ol>

<h4 id="é…ç½®æœåŠ¡å‚æ•°">é…ç½®æœåŠ¡å‚æ•°</h4>
<p><img src="https://i.loli.net/2019/08/03/NVzn54KaMyJYo8D.png" alt="" /></p>

<p>è¯¦ç»†é…ç½®ğŸ‘‰ <a href="https://www.linuxprobe.com/chapter-10.html#102">é…ç½®æœåŠ¡æ–‡ä»¶å‚æ•°</a></p>

<h2 id="selinux-å®‰å…¨å­ç³»ç»Ÿ">SELinux å®‰å…¨å­ç³»ç»Ÿ</h2>
<blockquote>
  <p>SELinux å®‰å…¨å­ç³»ç»Ÿèƒ½å¤Ÿä»å¤šæ–¹é¢ç›‘æ§è¿æ³•è¡Œä¸ºï¼šå¯¹æœåŠ¡ç¨‹åºçš„åŠŸèƒ½è¿›è¡Œé™åˆ¶ï¼ˆSELinuxåŸŸé™åˆ¶å¯ä»¥ç¡®ä¿æœåŠ¡ç¨‹åºåšä¸äº†å‡ºæ ¼çš„äº‹æƒ…ï¼‰ï¼›å¯¹æ–‡ä»¶èµ„æºçš„è®¿é—®é™åˆ¶ï¼ˆSELinuxå®‰å…¨ä¸Šä¸‹æ–‡ç¡®ä¿æ–‡ä»¶èµ„æºåªèƒ½è¢«å…¶æ‰€å±çš„æœåŠ¡ç¨‹åºè¿›è¡Œè®¿é—®ï¼‰ã€‚</p>
</blockquote>

<p>ç”±æ¦‚è¿°å¯çŸ¥ï¼Œâ€œSELinux åŸŸâ€å’Œâ€œSELinux å®‰å…¨ä¸Šä¸‹æ–‡â€æ˜¯Linuxç³»ç»Ÿçš„åŒä¿é™©ã€‚</p>

<p>å½“æˆ‘ä»¬å°†ç½‘ç«™é»˜è®¤ç›®å½•ä¿®æ”¹åˆ°å…¶ä»–ç›®å½•ä¸‹ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°æ— æ³•è®¿é—®çš„æƒ…å†µã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹å½“å‰ç›®å½•çš„ <code class="highlighter-rouge">SELinux å®‰å…¨ä¸Šä¸‹æ–‡</code> å’ŒåŸå§‹ç›®å½•ä¸€æ ·å³å¯</p>

<p>è¯¦è§ğŸ‘‰ <a href="https://www.linuxprobe.com/chapter-10.html#103SELinux">SELinuxå®‰å…¨å­ç³»ç»Ÿ</a></p>

<h2 id="è™šæ‹Ÿä¸»æœºåŠŸèƒ½">è™šæ‹Ÿä¸»æœºåŠŸèƒ½</h2>
<p>è™šæ‹Ÿä¸»æœºå¯ä»¥ç†è§£ä¸ºä¸€å°æœåŠ¡å™¨åˆ’åˆ†ä¸ºå¤šä¸ªè™šæ‹Ÿä¸»æœºï¼Œæ¯ä¸ªæ˜¯ç‹¬ç«‹çš„ï¼Œå¯å­˜æ”¾å„è‡ªçš„æ–‡ä»¶ã€‚</p>

<p>Apacheçš„è™šæ‹Ÿä¸»æœºåŠŸèƒ½æ˜¯æœåŠ¡å™¨åŸºäºç”¨æˆ·è¯·æ±‚çš„ä¸åŒ<strong>IPåœ°å€ã€ä¸»æœºåŸŸåæˆ–ç«¯å£å·</strong>ï¼Œå®ç°æä¾›å¤šä¸ªç½‘ç«™åŒæ—¶ä¸ºå¤–éƒ¨æä¾›è®¿é—®æœåŠ¡çš„æŠ€æœ¯ã€‚</p>

<p><img src="https://www.linuxprobe.com/wp-content/uploads/2015/05/Apache%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E5%8A%9F%E8%83%BD%E6%8B%93%E6%89%91.png" alt="" /></p>
<h4 id="åŸºäºä¸»æœºåŸŸå">åŸºäºä¸»æœºåŸŸå</h4>
<p>æˆ‘ä»¬ä»¥åŸºäºä¸»æœºåŸŸåä¸ºä¾‹ï¼ˆå®é™…æƒ…å†µç”¨åˆ°è¾ƒå¤šï¼‰ï¼Œæ¥æ¼”ç¤ºåœ¨è™šæ‹Ÿæœºä¸Šå¦‚ä½•åˆ›å»ºä¸‰ä¸ªä¸åŒçš„ç½‘ç«™</p>

<ol>
  <li>åˆ†åˆ«åœ¨<code class="highlighter-rouge">/home/wwwroot</code>ä¸­åˆ›å»ºä¸‰ä¸ªæ–‡ä»¶å¤¹ï¼Œæ¥ä¿å­˜å¯¹åº”ç½‘ç«™æ•°æ®ï¼Œå¹¶åˆ†åˆ«è¾“å…¥æ•°æ®æ¥è§‚çœ‹ç»“æœ
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre> <span class="o">[</span>root@linuxprobe ~]# <span class="nb">mkdir</span> <span class="nt">-p</span> /home/wwwroot/www
 <span class="o">[</span>root@linuxprobe ~]# <span class="nb">mkdir</span> <span class="nt">-p</span> /home/wwwroot/bbs
 <span class="o">[</span>root@linuxprobe ~]# <span class="nb">mkdir</span> <span class="nt">-p</span> /home/wwwroot/tech    //åˆ›å»ºä¸‰ä¸ªæ–‡ä»¶
 <span class="o">[</span>root@linuxprobe ~]# <span class="nb">echo</span> <span class="s2">"WWW.linuxprobe.com"</span> <span class="o">&gt;</span> /home/wwwroot/www/index.html
 <span class="o">[</span>root@linuxprobe ~]# <span class="nb">echo</span> <span class="s2">"BBS.linuxprobe.com"</span> <span class="o">&gt;</span> /home/wwwroot/bbs/index.html
 <span class="o">[</span>root@linuxprobe ~]# <span class="nb">echo</span> <span class="s2">"TECH.linuxprobe.com"</span> <span class="o">&gt;</span> /home/wwwroot/tech/index.html //è¾“å…¥æ•°æ®è‡³é¦–é¡µ
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>é…ç½®<code class="highlighter-rouge">httpdæœåŠ¡</code>ï¼Œè¿½åŠ ä¸‰ä¸ªåŸºäºä¸»æœºåçš„è™šæ‹Ÿä¸»æœºå‚æ•°
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre></td><td class="rouge-code"><pre> <span class="o">[</span>root@linuxprobe ~]# vim /etc/httpd/conf/httpd.conf
 â€¦â€¦â€¦â€¦â€¦â€¦çœç•¥éƒ¨åˆ†è¾“å‡ºä¿¡æ¯â€¦â€¦â€¦â€¦â€¦â€¦
 113 &lt;VirtualHost 192.168.10.10&gt;
 114 DocumentRoot <span class="s2">"/home/wwwroot/www"</span>    //ç½‘ç«™èµ„æºè·¯å¾„
 115 ServerName <span class="s2">"www.linuxprobe.com"</span>     //ç½‘ç«™åœ°å€
 116 &lt;Directory <span class="s2">"/home/wwwroot/www"</span><span class="o">&gt;</span>     //ç½‘ç«™èµ„æºè·¯å¾„
 117 AllowOverride None
 118 Require all granted
 119 &lt;/directory&gt; 
 120 &lt;/VirtualHost&gt;

 121 &lt;VirtualHost 192.168.10.10&gt;
 122 DocumentRoot <span class="s2">"/home/wwwroot/bbs"</span>
 123 ServerName <span class="s2">"bbs.linuxprobe.com"</span>
 124 &lt;Directory <span class="s2">"/home/wwwroot/bbs"</span><span class="o">&gt;</span>
 125 AllowOverride None
 126 Require all granted
 127 &lt;/Directory&gt;
 128 &lt;/VirtualHost&gt;

 129 &lt;VirtualHost 192.168.10.10&gt;
 130 DocumentRoot <span class="s2">"/home/wwwroot/tech"</span>
 131 ServerName <span class="s2">"tech.linuxprobe.com"</span>
 132 &lt;Directory <span class="s2">"/home/wwwroot/tech"</span><span class="o">&gt;</span>
 133 AllowOverride None
 134 Require all granted
 135 &lt;/directory&gt;
 136 &lt;/VirtualHost&gt;
 â€¦â€¦â€¦â€¦â€¦â€¦çœç•¥éƒ¨åˆ†è¾“å‡ºä¿¡æ¯â€¦â€¦â€¦â€¦â€¦â€¦
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>ä¿®æ”¹å¥½é…ç½®æ–‡ä»¶ï¼Œä¿å­˜å¹¶é€€å‡ºï¼Œ<strong>é‡å¯ <code class="highlighter-rouge">httpd</code> æœåŠ¡</strong></li>
  <li>å› ä¸ºæˆ‘ä»¬å°†ç½‘ç«™èµ„æºè·¯å¾„ä»é»˜è®¤åœ°å€è½¬ç§»ï¼Œæ‰€ä»¥åº”è¯¥ä¿®æ”¹æ­£ç¡®çš„<code class="highlighter-rouge">SELinuxå®‰å…¨ä¸Šä¸‹æ–‡</code>
    <div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre> <span class="o">[</span>root@linuxprobe ~]# semanage fcontext <span class="nt">-a</span> <span class="nt">-t</span> httpd_sys_content_t /home/wwwroot
 <span class="o">[</span>root@linuxprobe ~]# semanage fcontext <span class="nt">-a</span> <span class="nt">-t</span> httpd_sys_content_t /home/wwwroot/www
 <span class="o">[</span>root@linuxprobe ~]# semanage fcontext <span class="nt">-a</span> <span class="nt">-t</span> httpd_sys_content_t /home/wwwroot/www/<span class="k">*</span>
 <span class="o">[</span>root@linuxprobe ~]# semanage fcontext <span class="nt">-a</span> <span class="nt">-t</span> httpd_sys_content_t /home/wwwroot/bbs
 <span class="o">[</span>root@linuxprobe ~]# semanage fcontext <span class="nt">-a</span> <span class="nt">-t</span> httpd_sys_content_t /home/wwwroot/bbs/<span class="k">*</span>
 <span class="o">[</span>root@linuxprobe ~]# semanage fcontext <span class="nt">-a</span> <span class="nt">-t</span> httpd_sys_content_t /home/wwwroot/tech
 <span class="o">[</span>root@linuxprobe ~]# semanage fcontext <span class="nt">-a</span> <span class="nt">-t</span> httpd_sys_content_t /home/wwwroot/tech/<span class="k">*</span>
</pre></td></tr></tbody></table></code></pre></div>    </div>
  </li>
  <li>ä½¿æ–°é…ç½®çš„ <code class="highlighter-rouge">SELinuxå®‰å…¨ä¸Šä¸‹æ–‡</code>ç«‹å³ç”Ÿæ•ˆ <code class="highlighter-rouge">restorecon -Rv /home/wwwroot</code></li>
  <li>æµ‹è¯•ï¼ŒæˆåŠŸ!</li>
</ol>

<p>å…¶ä»–ä¸¤ç§è¯¦è§ğŸ‘‰ <a href="https://www.linuxprobe.com/chapter-10.html#105">é…ç½®è™šæ‹Ÿä¸»æœº</a></p>

<h2 id="apache-çš„è®¿é—®æ§åˆ¶">Apache çš„è®¿é—®æ§åˆ¶</h2>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre></td><td class="rouge-code"><pre><span class="o">[</span>root@linuxprobe ~]# vim /etc/httpd/conf/httpd.conf
â€¦â€¦â€¦â€¦â€¦â€¦çœç•¥éƒ¨åˆ†è¾“å‡ºä¿¡æ¯â€¦â€¦â€¦â€¦â€¦â€¦
129 &lt;Directory <span class="s2">"/var/www/html/server"</span><span class="o">&gt;</span>
130 SetEnvIf User-Agent <span class="s2">"Firefox"</span> <span class="nv">ff</span><span class="o">=</span>1
131 Order allow,deny
132 Allow from <span class="nb">env</span><span class="o">=</span>ff
133 &lt;/Directory&gt;
â€¦â€¦â€¦â€¦â€¦â€¦çœç•¥éƒ¨åˆ†è¾“å‡ºä¿¡æ¯â€¦â€¦â€¦â€¦â€¦â€¦
<span class="o">[</span>root@linuxprobe ~]# systemctl restart httpd
</pre></td></tr></tbody></table></code></pre></div></div>
<p>è¿›è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬ä¼šå‘ç° Firefox æµè§ˆå™¨æ— æ³•è®¿é—® 127.0.0.1ï¼Œå…¶ä»–æµè§ˆå™¨å‡å¯ä»¥ã€‚</p>

<h2 id="å›¾ç‰‡ç¬”è®°">å›¾ç‰‡ç¬”è®°</h2>
<p><img src="https://i.loli.net/2019/08/03/BxN4iwog1K8fydW.jpg" alt="" />
<img src="https://i.loli.net/2019/08/03/O1PN4C8jlQLcpHq.jpg" alt="" /></p>
:ET